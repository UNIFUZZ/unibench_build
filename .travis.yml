version: ~> 1.0
services:
  - docker

language: minimal

env:
  - TAG=gcc
  - TAG=afl
  - GIT_LFS_SKIP_SMUDGE=1

before_install:
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin

install:
  - docker pull unifuzz/unibench:$TAG || true
  - cd $TAG && docker build --cache-from unifuzz/unibench:$TAG -t unifuzz/unibench:$TAG .

deploy:
  provider: script
  script:
    - docker push unifuzz/unibench:$TAG
